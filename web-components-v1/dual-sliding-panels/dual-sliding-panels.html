<template id="dual-sliding-panels">
    <style>
        :host {
            --light-color: #f5f5f5;
            --dark-color: #151515;
            --gradient-start-l: #50c56c;
            --gradient-stop-l: #4ec4ce;
            --gradient-start-r: #50c56c;
            --gradient-stop-r: #4ec4ce;
        }

        main {
            height: 100%;
            overflow: hidden;
        }

        .panels {
            height: 100%;
            width: 200%;
        }

        .side {
            align-items: center;
            display: flex;
            float: left;
            height: 100%;
            justify-content: center;
            perspective: 500px;
            transition: all 500ms cubic-bezier(0.25, 1, 0.35, 1);
            width: 50%;
        }

        .side-left,
        .side-right {
            left: -25%;
            position: relative;
            transform: translateX(0);
            will-change: transform;
        }

        .side-left {
            background: var(--side-left-bg, var(--light-color));
            background-image: linear-gradient(to right, var(--side-left-gradient-start, var(--gradient-start-l)) 0%, var(--side-left-gradient-stop, var(--gradient-stop-l)) 100%);
            color: var(--dark-color);
        }

        .side-right {
            background: var(--side-right-bg, var(--dark-color));
            background-image: linear-gradient(to left, var(--side-right-gradient-start, var(--gradient-start-r)) 0%, var(--side-right-gradient-stop, var(--gradient-stop-r)) 100%);
            color: var(--light-color);
        }

        .side-left--active {
            transform: translateX(50%);
        }

        .side-left--active .side-left--inner {
            transform: rotateY(0);
        }

        .side-right--active {
            transform: translateX(-50%);
        }

        .side-right--active .side-right--inner {
            transform: rotateY(0);
        }

        .side-left--hidden {
            transform: translateX(-50%);
        }

        .side-right--hidden {
            transform: translateX(50%);
        }

        .side--inner {
            cursor: pointer;
        }

        .side-left--inner,
        .side-right--inner,
        .side--inner {
            height: 100%;
            padding: 0 5vw;
            transition-delay: 150ms;
            will-change: transform;
        }

        .side-left--inner {
            transform: rotateY(-90deg);
            transform-origin: right center;
        }

        .side-right--inner {
            transform: rotateY(90deg);
            transform-origin: left center;
        }

        ::slotted(*) {}
    </style>

    <main>
        <section class="panels">
            <aside class="side side-left">
                <div class="side side-left--inner">
                    <slot name="back--left"></slot>
                </div>
                <div class="side side--inner">
                    <slot name="front--left"></slot>
                </div>
            </aside>
            <aside class="side side-right">
                <div class="side side--inner">
                    <slot name="front--right"></slot>
                </div>
                <div class="side side-right--inner">
                    <slot name="back--right"></slot>
                </div>
            </aside>
        </section>
    </main>
</template>

<script>
    (function() {
        'use strict';

        const owner = document.currentScript.ownerDocument;
        const template = owner.querySelector('template');
        const content = template.content.cloneNode(true);
        const attrToObserve = [];

        class DualSlidingPanels extends HTMLElement {
            constructor() {
                super();

                this._shadowRoot = this.attachShadow({
                    mode: 'open'
                });

                this._shadowRoot.appendChild(content);

                this.panelLeft = this._findElement('.side-left');
                this.panelRight = this._findElement('.side-right');

                this.panelLeft.addEventListener('click', this.openLeft.bind(this), false);
                this.panelRight.addEventListener('click', this.openRight.bind(this), false);
            }

            static get observedAttributes() {
                return attrToObserve;
            }

            connectedCallback() {}

            disconnectedCallback() {}

            attributeChangedCallback(attrName, oldVal, newVal) {}

            openLeft(event) {
                this.panelLeft.classList.toggle('side-left--active');
                this.panelRight.classList.toggle('side-right--hidden');
            }

            openRight(event) {
                this.panelRight.classList.toggle('side-right--active');
                this.panelLeft.classList.toggle('side-left-hidden');
            }

            _findElement(selector) {
                return this._shadowRoot.querySelector(selector);
            }
        }

        window.customElements.define('dual-sliding-panels', DualSlidingPanels);

    }());
</script>
