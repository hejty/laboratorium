<template id="dual-sliding-panels">
    <style>
        main {
            height: 100%;
            overflow: hidden;
        }

        .panels {
            height: 100%;
            width: 200%;
        }

        .side {
            align-items: center;
            display: flex;
            float: left;
            height: 100%;
            justify-content: center;
            perspective: 500px;
            transition: all 500ms cubic-bezier(0.25, 1, 0.35, 1);
            width: 50%;
        }

        .side-left,
        .side-right {
            left: -25%;
            position: relative;
            transform: translate(0, 0);
            will-change: transform;
        }

        .side-left {
            background: #f5f5f5;
        }

        .side-right {
            background: #151515;
            color: white;
        }

        .side-left--active {
            transform: translate(50%, 0);
        }

        .side-left--active .side-left--inner {
            transform: rotateY(0);
        }

        .side-right--active {
            transform: translate(-50%, 0);
        }

        .side-right--active .side-right--inner {
            transform: rotateY(0);
        }

        .side-left--hidden {
            transform: translate(-50%, 0);
        }

        .side-right--hidden {
            transform: translate(50%, 0);
        }

        .side--inner {
            cursor: pointer;
        }

        .side-left--inner,
        .side-right--inner,
        .side--inner {
            height: 100%;
            padding: 0 5vw;
            will-change: transform;
        }

        .side-left--inner {
            transform: rotateY(-90deg);
            transform-origin: right center;
            transition-delay: 150ms;
        }

        .side-right--inner {
            transform: rotateY(90deg);
            transform-origin: left center;
            transition-delay: 150ms;
        }

        ::slotted(*) {
            border: 0.5vw solid tomato;
            padding: 1vw;
        }
    </style>

    <main>
        <section class="panels">
            <aside class="side side-left">
                <div class="side side-left--inner">
                    <slot name="back--left"></slot>
                </div>
                <div class="side side--inner">
                    <slot name="front--left"></slot>
                </div>
            </aside>
            <aside class="side side-right">
                <div class="side side--inner">
                    <slot name="front--right"></slot>
                </div>
                <div class="side side-right--inner">
                    <slot name="back--right"></slot>
                </div>
            </aside>
        </section>
    </main>
</template>

<script>
    (function() {
        'use strict';

        const owner = document.currentScript.ownerDocument;
        const template = owner.querySelector('template');
        const content = template.content.cloneNode(true);
        const attrToObserve = [];

        class DualSlidingPanels extends HTMLElement {
            constructor() {
                super();

                this._shadowRoot = this.attachShadow({
                    mode: 'open'
                });

                this._shadowRoot.appendChild(content);

                this.panelLeft = this._findElement('.side-left');
                this.panelRight = this._findElement('.side-right');

                this.panelLeft.addEventListener('click', this.openLeft.bind(this), false);
                this.panelRight.addEventListener('click', this.openRight.bind(this), false);
            }

            static get observedAttributes() {
                return attrToObserve;
            }

            connectedCallback() {}

            disconnectedCallback() {}

            attributeChangedCallback(attrName, oldVal, newVal) {}

            openLeft(event) {
                if (this._shadowRoot) {
                    this.panelLeft.classList.toggle('side-left--active');
                    this.panelRight.classList.toggle('side-right--hidden');
                }
            }

            openRight(event) {
                this.panelRight.classList.toggle('side-right--active');
                this.panelLeft.classList.toggle('side-left-hidden');
            }

            _findElement(selector) {
                return this._shadowRoot.querySelector(selector);
            }
        }

        window.customElements.define('dual-sliding-panels', DualSlidingPanels);

    }());
</script>
